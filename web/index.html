<!DOCTYPE html>
<html>
<title>IOT System</title>
<link rel="stylesheet" href="w3.css">
<script src="jquery-3.1.0.min.js"></script>
<script src="sweetalert.min.js"></script> 
<link rel="stylesheet" type="text/css" href="sweetalert.css">
<meta charset="UTF-8">
<body class="w3-container">

<!-- connect to station -->
<script>
  ws = new WebSocket("ws://192.168.5.156:8888/echo");
  function mypack(){
    station = [1,2,3]
  }
//var ws = new WebSocket("ws://127.0.0.1:8888/");
ws.onopen = function() {
   ws.send("Connect Sucess");
};

ws.onerror = function (error) {
  console.error('WebSocket Error ' + error);
  /*alert("error");*/
  swal("Connect Error!");
};

ws.onmessage = function (evt) {
  console.error('WebSocket recieved ' + evt.data);
  if (evt.type == "Text"){
    handleTextMessage(evt.data);
  }
   //swal(evt.data);
};
//---To stationA
function staA(){
       var c = document.getElementById("myCanvas");
       var ctx3 = c.getContext("2d");
        ctx3.beginPath();
        ctx3.arc(650, 300, 15, 0, 2 * Math.PI);
        ctx3.fillStyle = "red";
        ctx3.fill();
}
//---To stationB
function staB(){
       var c = document.getElementById("myCanvas");
       var ctx = c.getContext("2d");
        ctx1.beginPath();
        ctx1.arc(380, 50, 15, 0, 2 * Math.PI);
        ctx1.fillStyle = "red";
        ctx1.fill();
}
//---To stationC
 function staC(){
       var c = document.getElementById("myCanvas");
       var ctx2 = c.getContext("2d");
        ctx2.beginPath();
        ctx2.arc(50, 300, 15, 0, 2 * Math.PI);
        ctx2.fillStyle = "red";
        ctx2.fill();
 }
//---If car stop
 function error(){
   swal("Danger!", "Car near miss");
 }

function btn_getstationA(){
        var str = 'http://192.168.5.132:8888?callback=?&data=A';
        $.getJSON(str, function(json){ mypack(0) } );
        swal("Connect Sucess");
    }
function btn_getstationB(){
        var str = 'http://127.0.0.1:8888?callback=?&data=B';
        $.getJSON(str, function(json){ mypack(1) } );
        swal("Connect Sucess");
    }
function btn_getstationC(){
        var str = 'http://127.0.0.1:8888?callback=?&data=C';
         $.getJSON(str, function(json){ mypack(2) } );
        swal("Connect Sucess");
    }
>>>>>>> f2907cf46459b045b6f28038c17dfe4dfee137fb

function handleTextMessage(text){
  var message = JSON.parse(text);

  if(text == "A,a"){
    staA();
  }
 
  else if(text == "B,b"){
    staB();
  }
  
  else if(text == "C,c"){
   staC();
  }
  
  else if(text == "e"){
    error();
  }

}

//ws.send('message');




</script>

<style>
body,h1,h2,h3,h4,h5 {font-family: "Raleway", sans-serif}
</style>
<body class="w3-light-grey">
<div class="w3-content" style="max-width:1400px">

<!-- 表頭 -->
<header class="w3-container w3-light-grey">
<p><div class="w3-container w3-center w3-padding-32">
    <h1><b>工廠物流車系統</b></h1>
</div></p>
<!-- if range<=20 -->
<!--
<div  class="w3-container w3-section w3-red">
<span onclick="this.parentElement.style.display='none'" class="w3-closebtn">&times;</span>
  <h1>Danger!</h1>
  <p>Car near miss.</p>
</div>
-->
<!-- UI design -->
 <div class="w3-card-4 w3-margin w3-white">
    <div class="w3-container w3-padding-8">
      <h3><b>MAP</b></h3>
    </div>
    <div class="w3-container">
        <p> </p>
    <div class="w3-row">
<span style="background-color: #ffffff; font-size: 18px; font-weight: bold; color: #9900FF; padding-right:10px">
<!-- MAP -->
  <canvas id="myCanvas" width="700" height="500" style="border:0px solid #d3d3d3;">
Your browser does not support the HTML5 canvas tag.</canvas>

<script>

  var c = document.getElementById("myCanvas");
  var ctx = c.getContext("2d");
  //---stationB
  var ctx1 = c.getContext("2d");
  //---stationC
  var ctx2 = c.getContext("2d");
  //---stationA
  var ctx3 = c.getContext("2d");
  //---map
  ctx.lineWidth = 10;
  ctx.strokeRect(50, 50, 600, 400);
  //---stationB
  ctx1.beginPath();
  ctx1.arc(380, 50, 15, 0, 2 * Math.PI);
  ctx.font = "30px Arial";
  ctx.fillText("B", 370,100);
  ctx1.fillStyle = "black";
  ctx1.fill();
  //---stationC
  ctx2.beginPath();
  ctx2.arc(50, 300, 15, 0, 2 * Math.PI);
  ctx.font = "30px Arial";
  ctx.fillText("C", 70,310);
  ctx2.fillStyle = "black";
  ctx2.fill();
  //---stationA
  ctx3.beginPath();
  ctx3.arc(650, 300, 15, 0, 2 * Math.PI);
  ctx.font = "30px Arial";
  ctx.fillText("A", 600,310);
  ctx3.fillStyle = "black";
  ctx3.fill();

</script>

  <b>
    <p><button class="w3-btn w3-padding-large w3-white w3-border w3-hover-border-black" onclick="btn_getstationA()"><b>StationA</b></button></p>
    <p><button class="w3-btn w3-padding-large w3-white w3-border w3-hover-border-black" onclick="btn_getstationB()"><b>StationB</b></button></p>
    <p><button class="w3-btn w3-padding-large w3-white w3-border w3-hover-border-black" onclick="btn_getstationC()"><b>StationC</b></button></p>
  </b>
         </div>
      </div>
 </div>
  <hr>
<!-- Car1 to any station -->
<!--
<div class="w3-card-4 w3-margin w3-white">
    <div class="w3-container w3-padding-8">
      <h3><b>Car1</b></h3>
    </div>
    <div class="w3-container">
      
      
        <div class="w3-row">
        <div class="w3-col m8 s12">

          <p><button class="w3-btn-block w3-padding-large w3-white w3-border w3-hover-border-black" onclick="btn_getstationA()"><b>StationA</b></button></p>
          <p><button class="w3-btn-block w3-padding-large w3-white w3-border w3-hover-border-black" onclick="btn_getstationB()"><b>StationB</b></button></p>
          <p><button class="w3-btn-block w3-padding-large w3-white w3-border w3-hover-border-black" onclick="btn_getstationC()"><b>StationC</b></button></p>
        </div>
        </div>
      </div>
    </div>
</div>
-->
<!-- Footer -->
<footer class="w3-container w3-dark-grey w3-padding-32 w3-margin-top">
  <p>Powered by Kevin</p>
</footer>

</body>
</html>